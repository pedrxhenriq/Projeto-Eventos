<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Criar Evento</title>
    <script>
        function togglePrecoField() {
            var gratuitoCheckbox = document.getElementById("gratuito");
            var precoField = document.getElementById("preco");

            if (gratuitoCheckbox.checked) {
                precoField.disabled = true;
                precoField.value = "";
                precoField.removeAttribute("required");
            } else {
                precoField.disabled = false;
                precoField.setAttribute("required", "required");
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('cep').addEventListener('blur', function () {
                var cep = this.value.replace(/\D/g, '');

                if (cep.length !== 8) return;

                fetch(`/viacep/${cep}`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Erro ao buscar o CEP. Por favor, tente novamente.');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (!("erro" in data)) {
                            document.getElementById('logradouro').value = data.logradouro;
                            document.getElementById('bairro').value = data.bairro;
                            document.getElementById('cidade').value = data.localidade;
                            document.getElementById('uf').value = data.uf;
                            document.getElementById('numero').focus();
                        } else {
                            alert('CEP não encontrado.');
                        }
                    })
                    .catch(error => {
                        alert(error.message);
                    });
            });
        });

    </script>
</head>

<body>
    <h1>Criar Novo Evento</h1>
    <form method="post">
        <label for="titulo">Título:</label>
        <input type="text" id="titulo" name="titulo" required>
        <br>
        <label for="descricao">Descrição:</label>
        <textarea id="descricao" name="descricao" required></textarea>
        <br>
        <label for="data_inicio">Data de Início:</label>
        <input type="datetime-local" id="data_inicio" name="data_inicio" required>
        <br>
        <label for="data_fim">Data de Fim:</label>
        <input type="datetime-local" id="data_fim" name="data_fim" required>
        <br>
        <label for="capacidade">Capacidade:</label>
        <input type="number" id="capacidade" name="capacidade" required>
        <br>
        <label for="gratuito">Gratuito:</label>
        <input type="checkbox" id="gratuito" name="gratuito" onclick="togglePrecoField()">
        <br>
        <label for="preco">Preço:</label>
        <input type="number" step="0.01" id="preco" name="preco">
        <br>
        <label for="idade_minima">Idade Mínima:</label>
        <input type="number" id="idade_minima" name="idade_minima">
        <br>
        <label for="cep">CEP:</label>
        <input type="text" id="cep" name="cep" placeholder="00000-000">
        <br>
        <label for="logradouro">Logradouro:</label>
        <input type="text" id="logradouro" name="logradouro">
        <br>
        <label for="bairro">Bairro:</label>
        <input type="text" id="bairro" name="bairro">
        <br>
        <label for="cidade">Cidade:</label>
        <input type="text" id="cidade" name="cidade">
        <br>
        <label for="uf">UF:</label>
        <input type="text" id="uf" name="uf">
        <br>
        <label for="numero">Número:</label>
        <input type="text" id="numero" name="numero">
        <br>
        <button type="submit">Create</button>
    </form>
</body>

</html>